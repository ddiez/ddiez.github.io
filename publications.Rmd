---
title: ""
pagetitle: "Publications"
output: 
  html_document: 
    fig_height: 5
    fig_width: 5
---

```{r setup, include=FALSE}
library(tidyverse)
library(DT)
library(scholar)
library(plotly)
library(sparkline)
library(formattable)
library(ggthemes)
theme_set(theme_base(base_size = 12) + theme(plot.background = element_rect(color = NA)))
id <- "DmQLj7gAAAAJ" # my id.
```

<br>
```{r, echo=FALSE}
#p <- get_profile(id)
```

## List of publications

You can find here a list of my publications, sort them by column and filter them using the search box. Compared to the information shown in [my Google Scholar site](https://scholar.google.co.jp/citations?user=DmQLj7gAAAAJ&hl=en), only articles with more than one citation or published in the last two years are included.

```{r get_pub_data, echo=FALSE}
p <- get_publications(id)
mincit <- 1

# remove articles that have less than 2 citations unless they have been published in the last two years.
current_year <- as.numeric(format(Sys.time(), "%Y"))
valid_year <- current_year - 2
p <- p %>% filter(cites > mincit | year > valid_year, !is.na(cid), !is.na(year))

# get citations per article.
citart <- lapply(p$pubid, function(pubid) {
  tmp <- get_article_cite_history(id = id, pubid)
  Sys.sleep(3)
  tmp
}) %>% bind_rows() %>% complete(pubid, year, fill = list(cites = 0))
citart <- citart %>% group_by(pubid) %>% summarize(trend = spk_chr(cumsum(cites), type = "bar"))
p <- p %>% left_join(citart, by = "pubid") %>% replace_na(list(trend = ""))
```

```{r print_pub, echo=FALSE}
# print table.
pt <- p %>% select(year, cites, title, journal, author, trend) %>% arrange(desc(year))
#pt %>% formattable() %>% as.datatable(rownames = FALSE) %>% spk_add_deps()
#pt %>% datatable(rownames = FALSE, escape = FALSE) %>% spk_add_deps()
#pt %>% formattable() %>% as.htmlwidget() %>% spk_add_deps()
```
<br>

## Citations per year

This plot shows my citation history per year.

```{r citations, echo=FALSE}
cit <- get_citation_history(id)
cit$year <- factor(cit$year)
g <- ggplot(cit, aes(x = year, y = cites)) + geom_bar(stat = "identity", fill = "royalblue3") + labs(y = "count")
p <- suppressMessages(ggplotly(g))
p$x$config$displayModeBar <- 0
p
```

<br>

## Acknowledment

The information shown here is generated using the <a href="https://github.com/jkeirstead/scholar" target="_blank">scholar</a> R package to programmatically extract and analyze [Google Scholar](http://scholar.google.com) profiles. The interactive plot was generated using the [plotly](https://cran.r-project.org/package=plotly) R package.
